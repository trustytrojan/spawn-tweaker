# Spawn Tweaker — Copilot instructions

## What this repo is
- An all-in-one control suite for Minecraft Forge 1.12.2 spawning: spawn rules, spawn entry manipulation, and a custom configurable spawning algorithm.

## Toolchain (important)
- Based on the CleanroomMC Forge developer environment template (ForgeDevEnv): https://github.com/CleanroomMC/ForgeDevEnv
- The template uses RetroFuturaGradle (RFG) to decompile/patch Minecraft sources.
- Do NOT edit decompiled/patched outputs under `rfg/` or `build/` expecting behavior changes: these are regenerated by Gradle/RFG and the sources there do not get recompiled.
- Even though Forge 1.12.2 runs on Java 8, this dev environment allows writing code using Java 17 syntax.

## Build requirements
- JDK 17 is required to build.
- Avoid newer JDKs (e.g. JDK 25): Jabel depends on an older ByteBuddy version.
- Gradle is via the wrapper (`./gradlew`); no separate Gradle install/config is required.

## Code map (where things live)
- `src/main/java/dev/trustytrojan/spawn_tweaker` — root package for the mod.
- `src/main/java/dev/trustytrojan/spawn_tweaker/coremod` — FML coremod plugin(s) (kept separate; not used for anything else).
- `src/main/java/dev/trustytrojan/spawn_tweaker/event` — Forge/Vanilla event handlers/subscribers.
- `src/main/java/dev/trustytrojan/spawn_tweaker/mixin` — mixins/accessors; also contains the custom spawn algorithm.
- `src/main/java/dev/trustytrojan/spawn_tweaker/rule` — spawn rule system.
- `docs/` — authoritative syntax/behavior docs (`docs/rules.md`, `docs/conditions.md`, `docs/algorithm.md`).
- `examples/` — example YAML rule/entry files.
- `run/` — dev runtime snapshot; fastest loop is editing `run/config/spawn_tweaker/` then running the dev server.

## Key classes (start here)
- Entry point:
	- `src/main/java/dev/trustytrojan/spawn_tweaker/SpawnTweakerMod.java` — main mod class (instantiated by FML). Wires config dir + load order + command registration.
- Rules:
	- `src/main/java/dev/trustytrojan/spawn_tweaker/rule/SpawnRule.java` — YAML layout + compiled rule behavior.
	- `src/main/java/dev/trustytrojan/spawn_tweaker/SpawnRules.java` — loads/holds all rules.
- Spawn entry manipulation:
	- `src/main/java/dev/trustytrojan/spawn_tweaker/SpawnEntry.java` — YAML layout + applies entry modifications.
	- `src/main/java/dev/trustytrojan/spawn_tweaker/SpawnEntries.java` — loads/applies all entries.
	- `src/main/java/dev/trustytrojan/spawn_tweaker/OriginalEntries.java` — saves original biome spawn entries at init and restores them when `entries.yml` is empty (JSON is internal; `entries.yml` is a modifier file).
- Custom algorithm:
	- `src/main/java/dev/trustytrojan/spawn_tweaker/mixin/MixinWorldEntitySpawner.java` — replaces vanilla spawning (bytecode overwrite) with the custom algorithm.
	- `src/main/java/dev/trustytrojan/spawn_tweaker/SpawnAlgorithmConfig.java` — algorithm parameters.
- Runtime tooling:
	- `src/main/java/dev/trustytrojan/spawn_tweaker/CommandSpawnTweaker.java` — `/spawntweaker` dev/runtime command.
	- `src/main/java/dev/trustytrojan/spawn_tweaker/YamlLoader.java` — YAML loading helper.

## Runtime behavior (important semantics)
- User-facing config files are only `rules.yml` and `entries.yml` (under `run/config/spawn_tweaker/` in dev).
- Spawn entries currently only affect `EnumCreatureType.MONSTER` (they modify biome spawn lists for that creature type).
- Spawn rules intercept Forge's `CheckSpawn` event (from the spawn algorithm) and do not filter creature types themselves.

## Coding style (must follow)
- Prefer immutability everywhere: `private final` fields, `final` parameters (when it fits existing style), and `final var` locals.
- Use `var` (non-final) only when reassignment is required after initialization.
- Prefer `var`/`final var` over explicit types for conciseness; there are no exceptions.

## Workflows
- Build: `./gradlew build` (outputs under `build/libs/`).
- Dev runs: `./gradlew runServer` / `./gradlew runClient` (uses the `run/` layout).
- Rule testing: copy `examples/rules.yml` to `run/config/spawn_tweaker/`, run `runServer`, then inspect `run/logs/` and `run/crash-reports/`.

## When changing rule syntax
- Update `docs/rules.md` and/or `docs/conditions.md`.
- Add/adjust an example under `examples/`.
- Add a dev-run reproduction config under `run/config/spawn_tweaker/`.

## Releases
- Manual: create a GitHub Release and publish on the CurseForge project.
